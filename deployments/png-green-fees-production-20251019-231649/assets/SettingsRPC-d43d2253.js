import{u as C,r,s as u,j as e,m as w,S as b,C as h,a as x,b as g,d as p,L as y,I as f,B as v}from"./index-f386841f.js";import{R as j}from"./refresh-cw-4076d92b.js";import{S as E}from"./save-bfaf2e9f.js";const I=()=>{const{toast:i}=C(),[t,n]=r.useState({voucher_validity_days:30,default_amount:50}),[_,l]=r.useState(!0),[d,c]=r.useState(!1);r.useEffect(()=>{o()},[]);const o=async()=>{try{l(!0);const{data:s,error:a}=await u.rpc("get_system_settings");if(a)throw a;s&&s.length>0&&n(s[0])}catch(s){console.error("Error fetching settings:",s),i({title:"Error",description:"Failed to load system settings",variant:"destructive"})}finally{l(!1)}},N=async()=>{try{c(!0);const{error:s}=await u.rpc("update_system_settings",{p_voucher_validity_days:t.voucher_validity_days,p_default_amount:t.default_amount});if(s)throw s;i({title:"Success",description:"Settings updated successfully"})}catch(s){console.error("Error updating settings:",s),i({title:"Error",description:"Failed to update settings",variant:"destructive"})}finally{c(!1)}},m=(s,a)=>{n(S=>({...S,[s]:a}))};return _?e.jsx("div",{className:"flex items-center justify-center min-h-[400px]",children:e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-emerald-600"})}):e.jsxs(w.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5},className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(b,{className:"w-8 h-8 text-emerald-600"}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-800",children:"System Settings"}),e.jsx("p",{className:"text-gray-500",children:"Configure system-wide settings and preferences"})]})]}),e.jsxs(h,{children:[e.jsx(x,{children:e.jsx(g,{children:"General Settings"})}),e.jsxs(p,{className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(y,{htmlFor:"voucher_validity_days",children:"Voucher Validity (Days)"}),e.jsx(f,{id:"voucher_validity_days",type:"number",min:"1",max:"365",value:t.voucher_validity_days,onChange:s=>m("voucher_validity_days",parseInt(s.target.value)),placeholder:"Enter number of days"}),e.jsx("p",{className:"text-sm text-gray-500",children:"Number of days vouchers remain valid after creation"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(y,{htmlFor:"default_amount",children:"Default Amount (PGK)"}),e.jsx(f,{id:"default_amount",type:"number",step:"0.01",min:"0",value:t.default_amount,onChange:s=>m("default_amount",parseFloat(s.target.value)),placeholder:"Enter default amount"}),e.jsx("p",{className:"text-sm text-gray-500",children:"Default amount for green fee vouchers"})]})]}),e.jsxs("div",{className:"flex gap-3 pt-4",children:[e.jsx(v,{onClick:N,disabled:d,children:d?e.jsxs(e.Fragment,{children:[e.jsx(j,{className:"w-4 h-4 mr-2 animate-spin"}),"Saving..."]}):e.jsxs(e.Fragment,{children:[e.jsx(E,{className:"w-4 h-4 mr-2"}),"Save Settings"]})}),e.jsxs(v,{variant:"outline",onClick:o,children:[e.jsx(j,{className:"w-4 h-4 mr-2"}),"Refresh"]})]})]})]}),e.jsxs(h,{children:[e.jsx(x,{children:e.jsx(g,{children:"System Information"})}),e.jsx(p,{children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 text-sm",children:[e.jsxs("div",{children:[e.jsx("span",{className:"font-medium text-gray-700",children:"Last Updated:"}),e.jsx("span",{className:"ml-2 text-gray-600",children:t.updated_at?new Date(t.updated_at).toLocaleString():"Never"})]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-medium text-gray-700",children:"Created:"}),e.jsx("span",{className:"ml-2 text-gray-600",children:t.created_at?new Date(t.created_at).toLocaleString():"Unknown"})]})]})})]})]})};export{I as default};

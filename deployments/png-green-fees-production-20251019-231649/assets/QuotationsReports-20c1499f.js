import{u as y,r as i,s as j,j as t,I as d}from"./index-f386841f.js";import{X as v}from"./index.es-d321edd5.js";import{E as S}from"./ExportButton-bbdea4ab.js";import"./xlsx-f5126985.js";import"./file-spreadsheet-279cbcb4.js";const p=[{name:"Quotation",selector:e=>e.quotation,sortable:!0},{name:"Sent At",selector:e=>e.sentAt,sortable:!0},{name:"Customer",selector:e=>e.customer,sortable:!0},{name:"Expiry Date",selector:e=>e.expiryDate,sortable:!0},{name:"Notes",selector:e=>e.notes,sortable:!0},{name:"Price",selector:e=>e.price,sortable:!0,right:!0},{name:"Status",selector:e=>e.status,sortable:!0}],D={header:{style:{minHeight:"56px"}},headRow:{style:{borderTopStyle:"solid",borderTopWidth:"1px",borderTopColor:"#E2E8F0",backgroundColor:"#F8FAFC"}},headCells:{style:{"&:not(:last-of-type)":{borderRightStyle:"solid",borderRightWidth:"1px",borderRightColor:"#E2E8F0"},color:"#475569",fontSize:"12px",fontWeight:"600",textTransform:"uppercase"}},cells:{style:{"&:not(:last-of-type)":{borderRightStyle:"solid",borderRightWidth:"1px",borderRightColor:"#E2E8F0"}}}},l=({title:e,value:r})=>t.jsxs("div",{className:"bg-slate-50 p-4 rounded-lg shadow-sm border border-slate-200",children:[t.jsx("p",{className:"text-sm text-slate-500",children:e}),t.jsx("p",{className:"text-2xl font-bold text-slate-800",children:r})]}),R=()=>{const{toast:e}=y(),[r,m]=i.useState([]),[x,c]=i.useState(!0),[u,g]=i.useState([]);i.useEffect(()=>{h()},[]),i.useEffect(()=>{g(r)},[r]);const h=async()=>{try{c(!0);const{data:s,error:a}=await j.from("quotations").select("*").order("created_at",{ascending:!1});if(a)throw a;const f=(s||[]).map(o=>({id:o.id,quotation:o.quotation_number||`QUO-${o.id}`,sentAt:o.sent_at?new Date(o.sent_at).toLocaleDateString():"Not sent",customer:o.customer_name||o.company_name||"N/A",expiryDate:o.expiry_date?new Date(o.expiry_date).toLocaleDateString():"N/A",notes:o.notes||"",price:o.total_amount||o.price||0,status:o.status||"Draft"}));m(f)}catch(s){console.error("Error fetching quotations:",s),e({title:"Error",description:"Failed to load quotations",variant:"destructive"})}finally{c(!1)}},n=s=>r.filter(a=>a.status.toLowerCase()===s.toLowerCase()).length,b=r.reduce((s,a)=>s+(parseFloat(a.price)||0),0);return t.jsxs("div",{className:"space-y-6",children:[t.jsxs("div",{className:"flex flex-col sm:flex-row items-start sm:items-center justify-between gap-4",children:[t.jsx("h1",{className:"text-3xl font-bold bg-gradient-to-r from-emerald-600 to-teal-600 bg-clip-text text-transparent",children:"Quotations Reports"}),t.jsx(S,{data:u,columns:p,filename:"Quotations_Report",title:"Quotations Report"})]}),t.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-6 gap-4",children:[t.jsx(l,{title:"Total",value:r.length}),t.jsx(l,{title:"Draft",value:n("Draft")}),t.jsx(l,{title:"Sent",value:n("Sent")}),t.jsx(l,{title:"Approved",value:n("Approved")}),t.jsx(l,{title:"Converted",value:n("Converted")}),t.jsx(l,{title:"Amount Sum",value:`PGK ${b.toFixed(2)}`})]}),t.jsxs("div",{className:"bg-white/80 backdrop-blur-sm rounded-2xl p-6 shadow-lg border border-emerald-100",children:[t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4 mb-4",children:[t.jsx(d,{placeholder:"Filter by Status..."}),t.jsx(d,{type:"date",placeholder:"Start Date"}),t.jsx(d,{type:"date",placeholder:"End Date"}),t.jsx(d,{placeholder:"Filter by Creator..."})]}),t.jsx(v,{columns:p,data:u,pagination:!0,customStyles:D,highlightOnHover:!0,pointerOnHover:!0,progressPending:x})]})]})};export{R as default};

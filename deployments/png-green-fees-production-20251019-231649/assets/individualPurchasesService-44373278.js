import{ac as d,s as a}from"./index-f386841f.js";const l=async(t,r)=>{try{const o=d("IND");let e;t.validUntil?e=new Date(t.validUntil):(e=new Date,e.setDate(e.getDate()+30));const{data:n,error:i}=await a.from("individual_purchases").insert([{voucher_code:o,passport_id:t.passportId,passport_number:t.passportNumber,amount:t.amount,payment_method:t.paymentMethod,card_last_four:t.cardLastFour,valid_until:e.toISOString(),created_by:r}]).select().single();if(i)throw i;return await a.from("transactions").insert([{transaction_type:"individual",reference_id:n.id,amount:t.amount,payment_method:t.paymentMethod,passport_number:t.passportNumber,nationality:t.nationality,created_by:r}]),n}catch(o){throw console.error("Error creating individual purchase:",o),o}};export{l as c};

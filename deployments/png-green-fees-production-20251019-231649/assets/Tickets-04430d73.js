import{p as Ge,c as $,t as h,a2 as He,r as N,s as M,j as i,m as R,I as be,B as E,a3 as ft,a4 as _e,F as ht,f as xt,u as Ze,L as ee,v as Xe,A as vt}from"./index-f386841f.js";import{S as ae,a as ne,b as ie,c as se,d as A}from"./select-14269127.js";import{S as yt}from"./search-0da320f8.js";import{F as Ee}from"./filter-df158437.js";import{T as gt}from"./trash-2-10ec2eac.js";import{C as bt}from"./clock-24cb648f.js";import{P as jt}from"./plus-circle-a9eea528.js";import{j as w,_ as Ye,F as Je,H as At,I as wt,e as K,J as ke,K as C,L as S,M as Qe,N as Pe,O as et,D as Nt,G as kt,l as Pt,o as Z,r as U,S as Ot,A as St,P as Tt,m as Re,n as _t,i as W,q as Et,k as Rt,Q as tt,U as Ct,V as ce,w as Ce,W as de,t as It,v as Lt,Z as $t,R as Ie,T as Le,B as Dt,X as Ft,Y as Bt,z as ge}from"./BarChart-2dc98d28.js";import{T as rt}from"./textarea-2b2caf3d.js";import{A as at}from"./arrow-left-f0f484f3.js";import{S as Kt}from"./send-f7a2142e.js";const nt=Ge("Paperclip",[["path",{d:"m21.44 11.05-9.19 9.19a6 6 0 0 1-8.49-8.49l8.57-8.57A4 4 0 1 1 18 8.84l-8.59 8.57a2 2 0 0 1-2.83-2.83l8.49-8.48",key:"1u3ebp"}]]),$e=Ge("UserCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}],["path",{d:"M7 20.662V19a2 2 0 0 1 2-2h6a2 2 0 0 1 2 2v1.662",key:"154egf"}]]);var Vt=["points","className","baseLinePoints","connectNulls"];function G(){return G=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var a=arguments[e];for(var r in a)Object.prototype.hasOwnProperty.call(a,r)&&(t[r]=a[r])}return t},G.apply(this,arguments)}function Mt(t,e){if(t==null)return{};var a=qt(t,e),r,n;if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);for(n=0;n<o.length;n++)r=o[n],!(e.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(t,r)&&(a[r]=t[r])}return a}function qt(t,e){if(t==null)return{};var a={};for(var r in t)if(Object.prototype.hasOwnProperty.call(t,r)){if(e.indexOf(r)>=0)continue;a[r]=t[r]}return a}function De(t){return Gt(t)||Wt(t)||Ut(t)||zt()}function zt(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Ut(t,e){if(t){if(typeof t=="string")return je(t,e);var a=Object.prototype.toString.call(t).slice(8,-1);if(a==="Object"&&t.constructor&&(a=t.constructor.name),a==="Map"||a==="Set")return Array.from(t);if(a==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a))return je(t,e)}}function Wt(t){if(typeof Symbol<"u"&&t[Symbol.iterator]!=null||t["@@iterator"]!=null)return Array.from(t)}function Gt(t){if(Array.isArray(t))return je(t)}function je(t,e){(e==null||e>t.length)&&(e=t.length);for(var a=0,r=new Array(e);a<e;a++)r[a]=t[a];return r}var Fe=function(e){return e&&e.x===+e.x&&e.y===+e.y},Ht=function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],a=[[]];return e.forEach(function(r){Fe(r)?a[a.length-1].push(r):a[a.length-1].length>0&&a.push([])}),Fe(e[0])&&a[a.length-1].push(e[0]),a[a.length-1].length<=0&&(a=a.slice(0,-1)),a},te=function(e,a){var r=Ht(e);a&&(r=[r.reduce(function(o,s){return[].concat(De(o),De(s))},[])]);var n=r.map(function(o){return o.reduce(function(s,u,p){return"".concat(s).concat(p===0?"M":"L").concat(u.x,",").concat(u.y)},"")}).join("");return r.length===1?"".concat(n,"Z"):n},Zt=function(e,a,r){var n=te(e,r);return"".concat(n.slice(-1)==="Z"?n.slice(0,-1):n,"L").concat(te(a.reverse(),r).slice(1))},Xt=function(e){var a=e.points,r=e.className,n=e.baseLinePoints,o=e.connectNulls,s=Mt(e,Vt);if(!a||!a.length)return null;var u=$("recharts-polygon",r);if(n&&n.length){var p=s.stroke&&s.stroke!=="none",l=Zt(a,n,o);return h.createElement("g",{className:u},h.createElement("path",G({},w(s,!0),{fill:l.slice(-1)==="Z"?s.fill:"none",stroke:"none",d:l})),p?h.createElement("path",G({},w(s,!0),{fill:"none",d:te(a,o)})):null,p?h.createElement("path",G({},w(s,!0),{fill:"none",d:te(n,o)})):null)}var d=te(a,o);return h.createElement("path",G({},w(s,!0),{fill:d.slice(-1)==="Z"?s.fill:"none",className:u,d}))},Yt=Ye,Jt=At,Qt=Je;function er(t,e){return t&&t.length?Yt(t,Qt(e),Jt):void 0}var tr=er;const rr=He(tr);var ar=Ye,nr=Je,ir=wt;function sr(t,e){return t&&t.length?ar(t,nr(e),ir):void 0}var or=sr;const lr=He(or);var cr=["cx","cy","angle","ticks","axisLine"],dr=["ticks","tick","angle","tickFormatter","stroke"];function X(t){"@babel/helpers - typeof";return X=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},X(t)}function re(){return re=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var a=arguments[e];for(var r in a)Object.prototype.hasOwnProperty.call(a,r)&&(t[r]=a[r])}return t},re.apply(this,arguments)}function Be(t,e){var a=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(n){return Object.getOwnPropertyDescriptor(t,n).enumerable})),a.push.apply(a,r)}return a}function F(t){for(var e=1;e<arguments.length;e++){var a=arguments[e]!=null?arguments[e]:{};e%2?Be(Object(a),!0).forEach(function(r){he(t,r,a[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(a)):Be(Object(a)).forEach(function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(a,r))})}return t}function Ke(t,e){if(t==null)return{};var a=ur(t,e),r,n;if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);for(n=0;n<o.length;n++)r=o[n],!(e.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(t,r)&&(a[r]=t[r])}return a}function ur(t,e){if(t==null)return{};var a={};for(var r in t)if(Object.prototype.hasOwnProperty.call(t,r)){if(e.indexOf(r)>=0)continue;a[r]=t[r]}return a}function pr(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Ve(t,e){for(var a=0;a<e.length;a++){var r=e[a];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,st(r.key),r)}}function mr(t,e,a){return e&&Ve(t.prototype,e),a&&Ve(t,a),Object.defineProperty(t,"prototype",{writable:!1}),t}function fr(t,e,a){return e=pe(e),hr(t,it()?Reflect.construct(e,a||[],pe(t).constructor):e.apply(t,a))}function hr(t,e){if(e&&(X(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return xr(t)}function xr(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function it(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(it=function(){return!!t})()}function pe(t){return pe=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(a){return a.__proto__||Object.getPrototypeOf(a)},pe(t)}function vr(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Ae(t,e)}function Ae(t,e){return Ae=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(r,n){return r.__proto__=n,r},Ae(t,e)}function he(t,e,a){return e=st(e),e in t?Object.defineProperty(t,e,{value:a,enumerable:!0,configurable:!0,writable:!0}):t[e]=a,t}function st(t){var e=yr(t,"string");return X(e)=="symbol"?e:e+""}function yr(t,e){if(X(t)!="object"||!t)return t;var a=t[Symbol.toPrimitive];if(a!==void 0){var r=a.call(t,e||"default");if(X(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var xe=function(t){function e(){return pr(this,e),fr(this,e,arguments)}return vr(e,t),mr(e,[{key:"getTickValueCoord",value:function(r){var n=r.coordinate,o=this.props,s=o.angle,u=o.cx,p=o.cy;return C(u,p,n,s)}},{key:"getTickTextAnchor",value:function(){var r=this.props.orientation,n;switch(r){case"left":n="end";break;case"right":n="start";break;default:n="middle";break}return n}},{key:"getViewBox",value:function(){var r=this.props,n=r.cx,o=r.cy,s=r.angle,u=r.ticks,p=rr(u,function(d){return d.coordinate||0}),l=lr(u,function(d){return d.coordinate||0});return{cx:n,cy:o,startAngle:s,endAngle:s,innerRadius:l.coordinate||0,outerRadius:p.coordinate||0}}},{key:"renderAxisLine",value:function(){var r=this.props,n=r.cx,o=r.cy,s=r.angle,u=r.ticks,p=r.axisLine,l=Ke(r,cr),d=u.reduce(function(v,m){return[Math.min(v[0],m.coordinate),Math.max(v[1],m.coordinate)]},[1/0,-1/0]),c=C(n,o,d[0],s),f=C(n,o,d[1],s),b=F(F(F({},w(l,!1)),{},{fill:"none"},w(p,!1)),{},{x1:c.x,y1:c.y,x2:f.x,y2:f.y});return h.createElement("line",re({className:"recharts-polar-radius-axis-line"},b))}},{key:"renderTicks",value:function(){var r=this,n=this.props,o=n.ticks,s=n.tick,u=n.angle,p=n.tickFormatter,l=n.stroke,d=Ke(n,dr),c=this.getTickTextAnchor(),f=w(d,!1),b=w(s,!1),v=o.map(function(m,x){var y=r.getTickValueCoord(m),j=F(F(F(F({textAnchor:c,transform:"rotate(".concat(90-u,", ").concat(y.x,", ").concat(y.y,")")},f),{},{stroke:"none",fill:l},b),{},{index:x},y),{},{payload:m});return h.createElement(S,re({className:$("recharts-polar-radius-axis-tick",Qe(s)),key:"tick-".concat(m.coordinate)},Pe(r.props,m,x)),e.renderTickItem(s,j,p?p(m.value,x):m.value))});return h.createElement(S,{className:"recharts-polar-radius-axis-ticks"},v)}},{key:"render",value:function(){var r=this.props,n=r.ticks,o=r.axisLine,s=r.tick;return!n||!n.length?null:h.createElement(S,{className:$("recharts-polar-radius-axis",this.props.className)},o&&this.renderAxisLine(),s&&this.renderTicks(),et.renderCallByParent(this.props,this.getViewBox()))}}],[{key:"renderTickItem",value:function(r,n,o){var s;return h.isValidElement(r)?s=h.cloneElement(r,n):K(r)?s=r(n):s=h.createElement(ke,re({},n,{className:"recharts-polar-radius-axis-tick-value"}),o),s}}])}(N.PureComponent);he(xe,"displayName","PolarRadiusAxis");he(xe,"axisType","radiusAxis");he(xe,"defaultProps",{type:"number",radiusAxisId:0,cx:0,cy:0,angle:0,orientation:"right",stroke:"#ccc",axisLine:!0,tick:!0,tickCount:5,allowDataOverflow:!1,scale:"auto",allowDuplicatedCategory:!0});function Y(t){"@babel/helpers - typeof";return Y=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Y(t)}function V(){return V=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var a=arguments[e];for(var r in a)Object.prototype.hasOwnProperty.call(a,r)&&(t[r]=a[r])}return t},V.apply(this,arguments)}function Me(t,e){var a=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(n){return Object.getOwnPropertyDescriptor(t,n).enumerable})),a.push.apply(a,r)}return a}function B(t){for(var e=1;e<arguments.length;e++){var a=arguments[e]!=null?arguments[e]:{};e%2?Me(Object(a),!0).forEach(function(r){ve(t,r,a[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(a)):Me(Object(a)).forEach(function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(a,r))})}return t}function gr(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function qe(t,e){for(var a=0;a<e.length;a++){var r=e[a];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,lt(r.key),r)}}function br(t,e,a){return e&&qe(t.prototype,e),a&&qe(t,a),Object.defineProperty(t,"prototype",{writable:!1}),t}function jr(t,e,a){return e=me(e),Ar(t,ot()?Reflect.construct(e,a||[],me(t).constructor):e.apply(t,a))}function Ar(t,e){if(e&&(Y(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return wr(t)}function wr(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function ot(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(ot=function(){return!!t})()}function me(t){return me=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(a){return a.__proto__||Object.getPrototypeOf(a)},me(t)}function Nr(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&we(t,e)}function we(t,e){return we=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(r,n){return r.__proto__=n,r},we(t,e)}function ve(t,e,a){return e=lt(e),e in t?Object.defineProperty(t,e,{value:a,enumerable:!0,configurable:!0,writable:!0}):t[e]=a,t}function lt(t){var e=kr(t,"string");return Y(e)=="symbol"?e:e+""}function kr(t,e){if(Y(t)!="object"||!t)return t;var a=t[Symbol.toPrimitive];if(a!==void 0){var r=a.call(t,e||"default");if(Y(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var Pr=Math.PI/180,ze=1e-5,ye=function(t){function e(){return gr(this,e),jr(this,e,arguments)}return Nr(e,t),br(e,[{key:"getTickLineCoord",value:function(r){var n=this.props,o=n.cx,s=n.cy,u=n.radius,p=n.orientation,l=n.tickSize,d=l||8,c=C(o,s,u,r.coordinate),f=C(o,s,u+(p==="inner"?-1:1)*d,r.coordinate);return{x1:c.x,y1:c.y,x2:f.x,y2:f.y}}},{key:"getTickTextAnchor",value:function(r){var n=this.props.orientation,o=Math.cos(-r.coordinate*Pr),s;return o>ze?s=n==="outer"?"start":"end":o<-ze?s=n==="outer"?"end":"start":s="middle",s}},{key:"renderAxisLine",value:function(){var r=this.props,n=r.cx,o=r.cy,s=r.radius,u=r.axisLine,p=r.axisLineType,l=B(B({},w(this.props,!1)),{},{fill:"none"},w(u,!1));if(p==="circle")return h.createElement(Nt,V({className:"recharts-polar-angle-axis-line"},l,{cx:n,cy:o,r:s}));var d=this.props.ticks,c=d.map(function(f){return C(n,o,s,f.coordinate)});return h.createElement(Xt,V({className:"recharts-polar-angle-axis-line"},l,{points:c}))}},{key:"renderTicks",value:function(){var r=this,n=this.props,o=n.ticks,s=n.tick,u=n.tickLine,p=n.tickFormatter,l=n.stroke,d=w(this.props,!1),c=w(s,!1),f=B(B({},d),{},{fill:"none"},w(u,!1)),b=o.map(function(v,m){var x=r.getTickLineCoord(v),y=r.getTickTextAnchor(v),j=B(B(B({textAnchor:y},d),{},{stroke:"none",fill:l},c),{},{index:m,payload:v,x:x.x2,y:x.y2});return h.createElement(S,V({className:$("recharts-polar-angle-axis-tick",Qe(s)),key:"tick-".concat(v.coordinate)},Pe(r.props,v,m)),u&&h.createElement("line",V({className:"recharts-polar-angle-axis-tick-line"},f,x)),s&&e.renderTickItem(s,j,p?p(v.value,m):v.value))});return h.createElement(S,{className:"recharts-polar-angle-axis-ticks"},b)}},{key:"render",value:function(){var r=this.props,n=r.ticks,o=r.radius,s=r.axisLine;return o<=0||!n||!n.length?null:h.createElement(S,{className:$("recharts-polar-angle-axis",this.props.className)},s&&this.renderAxisLine(),this.renderTicks())}}],[{key:"renderTickItem",value:function(r,n,o){var s;return h.isValidElement(r)?s=h.cloneElement(r,n):K(r)?s=r(n):s=h.createElement(ke,V({},n,{className:"recharts-polar-angle-axis-tick-value"}),o),s}}])}(N.PureComponent);ve(ye,"displayName","PolarAngleAxis");ve(ye,"axisType","angleAxis");ve(ye,"defaultProps",{type:"category",angleAxisId:0,scale:"auto",cx:0,cy:0,orientation:"outer",axisLine:!0,tickLine:!0,tickSize:8,tick:!0,hide:!1,allowDuplicatedCategory:!0});var ue;function J(t){"@babel/helpers - typeof";return J=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},J(t)}function H(){return H=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var a=arguments[e];for(var r in a)Object.prototype.hasOwnProperty.call(a,r)&&(t[r]=a[r])}return t},H.apply(this,arguments)}function Ue(t,e){var a=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(n){return Object.getOwnPropertyDescriptor(t,n).enumerable})),a.push.apply(a,r)}return a}function g(t){for(var e=1;e<arguments.length;e++){var a=arguments[e]!=null?arguments[e]:{};e%2?Ue(Object(a),!0).forEach(function(r){P(t,r,a[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(a)):Ue(Object(a)).forEach(function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(a,r))})}return t}function Or(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function We(t,e){for(var a=0;a<e.length;a++){var r=e[a];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,dt(r.key),r)}}function Sr(t,e,a){return e&&We(t.prototype,e),a&&We(t,a),Object.defineProperty(t,"prototype",{writable:!1}),t}function Tr(t,e,a){return e=fe(e),_r(t,ct()?Reflect.construct(e,a||[],fe(t).constructor):e.apply(t,a))}function _r(t,e){if(e&&(J(e)==="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Er(t)}function Er(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function ct(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(ct=function(){return!!t})()}function fe(t){return fe=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(a){return a.__proto__||Object.getPrototypeOf(a)},fe(t)}function Rr(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Ne(t,e)}function Ne(t,e){return Ne=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(r,n){return r.__proto__=n,r},Ne(t,e)}function P(t,e,a){return e=dt(e),e in t?Object.defineProperty(t,e,{value:a,enumerable:!0,configurable:!0,writable:!0}):t[e]=a,t}function dt(t){var e=Cr(t,"string");return J(e)=="symbol"?e:e+""}function Cr(t,e){if(J(t)!="object"||!t)return t;var a=t[Symbol.toPrimitive];if(a!==void 0){var r=a.call(t,e||"default");if(J(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var I=function(t){function e(a){var r;return Or(this,e),r=Tr(this,e,[a]),P(r,"pieRef",null),P(r,"sectorRefs",[]),P(r,"id",It("recharts-pie-")),P(r,"handleAnimationEnd",function(){var n=r.props.onAnimationEnd;r.setState({isAnimationFinished:!0}),K(n)&&n()}),P(r,"handleAnimationStart",function(){var n=r.props.onAnimationStart;r.setState({isAnimationFinished:!1}),K(n)&&n()}),r.state={isAnimationFinished:!a.isAnimationActive,prevIsAnimationActive:a.isAnimationActive,prevAnimationId:a.animationId,sectorToFocus:0},r}return Rr(e,t),Sr(e,[{key:"isActiveIndex",value:function(r){var n=this.props.activeIndex;return Array.isArray(n)?n.indexOf(r)!==-1:r===n}},{key:"hasActiveIndex",value:function(){var r=this.props.activeIndex;return Array.isArray(r)?r.length!==0:r||r===0}},{key:"renderLabels",value:function(r){var n=this.props.isAnimationActive;if(n&&!this.state.isAnimationFinished)return null;var o=this.props,s=o.label,u=o.labelLine,p=o.dataKey,l=o.valueKey,d=w(this.props,!1),c=w(s,!1),f=w(u,!1),b=s&&s.offsetRadius||20,v=r.map(function(m,x){var y=(m.startAngle+m.endAngle)/2,j=C(m.cx,m.cy,m.outerRadius+b,y),O=g(g(g(g({},d),m),{},{stroke:"none"},c),{},{index:x,textAnchor:e.getTextAnchor(j.x,m.cx)},j),q=g(g(g(g({},d),m),{},{fill:"none",stroke:m.fill},f),{},{index:x,points:[C(m.cx,m.cy,m.outerRadius,y),j]}),T=p;return Z(p)&&Z(l)?T="value":Z(p)&&(T=l),h.createElement(S,{key:"label-".concat(m.startAngle,"-").concat(m.endAngle,"-").concat(m.midAngle,"-").concat(x)},u&&e.renderLabelLineItem(u,q,"line"),e.renderLabelItem(s,O,U(m,T)))});return h.createElement(S,{className:"recharts-pie-labels"},v)}},{key:"renderSectorsStatically",value:function(r){var n=this,o=this.props,s=o.activeShape,u=o.blendStroke,p=o.inactiveShape;return r.map(function(l,d){if((l==null?void 0:l.startAngle)===0&&(l==null?void 0:l.endAngle)===0&&r.length!==1)return null;var c=n.isActiveIndex(d),f=p&&n.hasActiveIndex()?p:null,b=c?s:f,v=g(g({},l),{},{stroke:u?l.fill:l.stroke,tabIndex:-1});return h.createElement(S,H({ref:function(x){x&&!n.sectorRefs.includes(x)&&n.sectorRefs.push(x)},tabIndex:-1,className:"recharts-pie-sector"},Pe(n.props,l,d),{key:"sector-".concat(l==null?void 0:l.startAngle,"-").concat(l==null?void 0:l.endAngle,"-").concat(l.midAngle,"-").concat(d)}),h.createElement(Ot,H({option:b,isActive:c,shapeType:"sector"},v)))})}},{key:"renderSectorsWithAnimation",value:function(){var r=this,n=this.props,o=n.sectors,s=n.isAnimationActive,u=n.animationBegin,p=n.animationDuration,l=n.animationEasing,d=n.animationId,c=this.state,f=c.prevSectors,b=c.prevIsAnimationActive;return h.createElement(St,{begin:u,duration:p,isActive:s,easing:l,from:{t:0},to:{t:1},key:"pie-".concat(d,"-").concat(b),onAnimationStart:this.handleAnimationStart,onAnimationEnd:this.handleAnimationEnd},function(v){var m=v.t,x=[],y=o&&o[0],j=y.startAngle;return o.forEach(function(O,q){var T=f&&f[q],D=q>0?Tt(O,"paddingAngle",0):0;if(T){var Q=Re(T.endAngle-T.startAngle,O.endAngle-O.startAngle),k=g(g({},O),{},{startAngle:j+D,endAngle:j+Q(m)+D});x.push(k),j=k.endAngle}else{var z=O.endAngle,_=O.startAngle,oe=Re(0,z-_),le=oe(m),L=g(g({},O),{},{startAngle:j+D,endAngle:j+le+D});x.push(L),j=L.endAngle}}),h.createElement(S,null,r.renderSectorsStatically(x))})}},{key:"attachKeyboardHandlers",value:function(r){var n=this;r.onkeydown=function(o){if(!o.altKey)switch(o.key){case"ArrowLeft":{var s=++n.state.sectorToFocus%n.sectorRefs.length;n.sectorRefs[s].focus(),n.setState({sectorToFocus:s});break}case"ArrowRight":{var u=--n.state.sectorToFocus<0?n.sectorRefs.length-1:n.state.sectorToFocus%n.sectorRefs.length;n.sectorRefs[u].focus(),n.setState({sectorToFocus:u});break}case"Escape":{n.sectorRefs[n.state.sectorToFocus].blur(),n.setState({sectorToFocus:0});break}}}}},{key:"renderSectors",value:function(){var r=this.props,n=r.sectors,o=r.isAnimationActive,s=this.state.prevSectors;return o&&n&&n.length&&(!s||!_t(s,n))?this.renderSectorsWithAnimation():this.renderSectorsStatically(n)}},{key:"componentDidMount",value:function(){this.pieRef&&this.attachKeyboardHandlers(this.pieRef)}},{key:"render",value:function(){var r=this,n=this.props,o=n.hide,s=n.sectors,u=n.className,p=n.label,l=n.cx,d=n.cy,c=n.innerRadius,f=n.outerRadius,b=n.isAnimationActive,v=this.state.isAnimationFinished;if(o||!s||!s.length||!W(l)||!W(d)||!W(c)||!W(f))return null;var m=$("recharts-pie",u);return h.createElement(S,{tabIndex:this.props.rootTabIndex,className:m,ref:function(y){r.pieRef=y}},this.renderSectors(),p&&this.renderLabels(s),et.renderCallByParent(this.props,null,!1),(!b||v)&&Et.renderCallByParent(this.props,s,!1))}}],[{key:"getDerivedStateFromProps",value:function(r,n){return n.prevIsAnimationActive!==r.isAnimationActive?{prevIsAnimationActive:r.isAnimationActive,prevAnimationId:r.animationId,curSectors:r.sectors,prevSectors:[],isAnimationFinished:!0}:r.isAnimationActive&&r.animationId!==n.prevAnimationId?{prevAnimationId:r.animationId,curSectors:r.sectors,prevSectors:n.curSectors,isAnimationFinished:!0}:r.sectors!==n.curSectors?{curSectors:r.sectors,isAnimationFinished:!0}:null}},{key:"getTextAnchor",value:function(r,n){return r>n?"start":r<n?"end":"middle"}},{key:"renderLabelLineItem",value:function(r,n,o){if(h.isValidElement(r))return h.cloneElement(r,n);if(K(r))return r(n);var s=$("recharts-pie-label-line",typeof r!="boolean"?r.className:"");return h.createElement(Pt,H({},n,{key:o,type:"linear",className:s}))}},{key:"renderLabelItem",value:function(r,n,o){if(h.isValidElement(r))return h.cloneElement(r,n);var s=o;if(K(r)&&(s=r(n),h.isValidElement(s)))return s;var u=$("recharts-pie-label-text",typeof r!="boolean"&&!K(r)?r.className:"");return h.createElement(ke,H({},n,{alignmentBaseline:"middle",className:u}),s)}}])}(N.PureComponent);ue=I;P(I,"displayName","Pie");P(I,"defaultProps",{stroke:"#fff",fill:"#808080",legendType:"rect",cx:"50%",cy:"50%",startAngle:0,endAngle:360,innerRadius:0,outerRadius:"80%",paddingAngle:0,labelLine:!0,hide:!1,minAngle:0,isAnimationActive:!kt.isSsr,animationBegin:400,animationDuration:1500,animationEasing:"ease",nameKey:"name",blendStroke:!1,rootTabIndex:0});P(I,"parseDeltaAngle",function(t,e){var a=de(e-t),r=Math.min(Math.abs(e-t),360);return a*r});P(I,"getRealPieData",function(t){var e=t.data,a=t.children,r=w(t,!1),n=Rt(a,tt);return e&&e.length?e.map(function(o,s){return g(g(g({payload:o},r),o),n&&n[s]&&n[s].props)}):n&&n.length?n.map(function(o){return g(g({},r),o.props)}):[]});P(I,"parseCoordinateOfPie",function(t,e){var a=e.top,r=e.left,n=e.width,o=e.height,s=Ct(n,o),u=r+ce(t.cx,n,n/2),p=a+ce(t.cy,o,o/2),l=ce(t.innerRadius,s,0),d=ce(t.outerRadius,s,s*.8),c=t.maxRadius||Math.sqrt(n*n+o*o)/2;return{cx:u,cy:p,innerRadius:l,outerRadius:d,maxRadius:c}});P(I,"getComposedData",function(t){var e=t.item,a=t.offset,r=e.type.defaultProps!==void 0?g(g({},e.type.defaultProps),e.props):e.props,n=ue.getRealPieData(r);if(!n||!n.length)return null;var o=r.cornerRadius,s=r.startAngle,u=r.endAngle,p=r.paddingAngle,l=r.dataKey,d=r.nameKey,c=r.valueKey,f=r.tooltipType,b=Math.abs(r.minAngle),v=ue.parseCoordinateOfPie(r,a),m=ue.parseDeltaAngle(s,u),x=Math.abs(m),y=l;Z(l)&&Z(c)?(Ce(!1,`Use "dataKey" to specify the value of pie,
      the props "valueKey" will be deprecated in 1.1.0`),y="value"):Z(l)&&(Ce(!1,`Use "dataKey" to specify the value of pie,
      the props "valueKey" will be deprecated in 1.1.0`),y=c);var j=n.filter(function(k){return U(k,y,0)!==0}).length,O=(x>=360?j:j-1)*p,q=x-j*b-O,T=n.reduce(function(k,z){var _=U(z,y,0);return k+(W(_)?_:0)},0),D;if(T>0){var Q;D=n.map(function(k,z){var _=U(k,y,0),oe=U(k,d,z),le=(W(_)?_:0)/T,L;z?L=Q.endAngle+de(m)*p*(_!==0?1:0):L=s;var Oe=L+de(m)*((_!==0?b:0)+le*q),Se=(L+Oe)/2,Te=(v.innerRadius+v.outerRadius)/2,pt=[{name:oe,value:_,payload:k,dataKey:y,type:f}],mt=C(v.cx,v.cy,Te,Se);return Q=g(g(g({percent:le,cornerRadius:o,name:oe,tooltipPayload:pt,midAngle:Se,middleRadius:Te,tooltipPosition:mt},k),v),{},{value:U(k,y),startAngle:L,endAngle:Oe,payload:k,paddingAngle:de(m)*p}),Q})}return g(g({},v),{},{sectors:D,data:n})});var Ir=Lt({chartName:"PieChart",GraphicalChild:I,validateTooltipEventTypes:["item"],defaultTooltipEventType:"item",legendContent:"children",axisComponents:[{axisType:"angleAxis",AxisComp:ye},{axisType:"radiusAxis",AxisComp:xe}],formatAxisMap:$t,defaultProps:{layout:"centric",startAngle:0,endAngle:360,cx:"50%",cy:"50%",innerRadius:0,outerRadius:"80%"}});const ut=()=>{const t=Date.now().toString(36).toUpperCase(),e=Math.random().toString(36).substring(2,6).toUpperCase();return`TKT-${t}-${e}`},Lr=async()=>{try{const{data:t,error:e}=await M.from("tickets").select("*").order("created_at",{ascending:!1});if(e)throw e;return t.map(a=>({id:a.id,ticketNumber:a.ticket_number,title:a.title,description:a.description,priority:a.priority,status:a.status,createdAt:a.created_at,responses:a.responses||[],createdBy:a.created_by}))}catch(t){return console.error("Error loading tickets:",t),[]}},$r=async(t,e)=>{try{const{data:a,error:r}=await M.from("tickets").insert([{ticket_number:ut(),title:t.title,description:t.description,priority:t.priority||"medium",status:"open",created_by:e,responses:[]}]).select().single();if(r)throw r;return{id:a.id,ticketNumber:a.ticket_number,title:a.title,description:a.description,priority:a.priority,status:a.status,createdAt:a.created_at,responses:a.responses||[],createdBy:a.created_by}}catch(a){throw console.error("Error creating ticket:",a),a}},Dr=async(t,e)=>{try{const a={};e.title!==void 0&&(a.title=e.title),e.description!==void 0&&(a.description=e.description),e.priority!==void 0&&(a.priority=e.priority),e.status!==void 0&&(a.status=e.status),e.responses!==void 0&&(a.responses=e.responses);const{data:r,error:n}=await M.from("tickets").update(a).eq("id",t).select().single();if(n)throw n;return{id:r.id,ticketNumber:r.ticket_number,title:r.title,description:r.description,priority:r.priority,status:r.status,createdAt:r.created_at,responses:r.responses||[],createdBy:r.created_by}}catch(a){return console.error("Error updating ticket:",a),null}},Fr=async t=>{try{const{error:e}=await M.from("tickets").delete().eq("id",t);if(e)throw e}catch(e){throw console.error("Error deleting ticket:",e),e}},Br=async(t,e)=>{try{const{data:a,error:r}=await M.from("tickets").select("responses").eq("id",t).single();if(r)throw r;const n=a.responses||[];n.push({message:e,timestamp:new Date().toISOString()});const{data:o,error:s}=await M.from("tickets").update({responses:n}).eq("id",t).select().single();if(s)throw s;return{id:o.id,ticketNumber:o.ticket_number,title:o.title,description:o.description,priority:o.priority,status:o.status,createdAt:o.created_at,responses:o.responses||[],createdBy:o.created_by}}catch(a){return console.error("Error adding response:",a),null}},Kr=({tickets:t,onViewTicket:e,onTicketsUpdated:a})=>{const[r,n]=N.useState(""),[o,s]=N.useState("all"),[u,p]=N.useState("all"),l=t.filter(c=>{const f=c.subject.toLowerCase().includes(r.toLowerCase())||c.description.toLowerCase().includes(r.toLowerCase())||c.ticketNumber.toLowerCase().includes(r.toLowerCase()),b=o==="all"||c.status===o,v=u==="all"||c.priority===u;return f&&b&&v}),d=async(c,f)=>{if(window.confirm(`Are you sure you want to delete ticket #${f}?`))try{await Fr(c),_e({title:"Ticket Deleted",description:`Ticket #${f} has been removed`}),a()}catch{_e({title:"Error",description:"Failed to delete ticket. Please try again.",variant:"destructive"})}};return i.jsxs("div",{className:"space-y-6",children:[i.jsxs(R.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5},children:[i.jsx("h2",{className:"text-3xl font-bold bg-gradient-to-r from-emerald-600 to-teal-600 bg-clip-text text-transparent mb-2",children:"All Tickets"}),i.jsx("p",{className:"text-gray-600",children:"Manage and track all your exit tickets"})]}),i.jsxs(R.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5,delay:.1},className:"bg-white/80 backdrop-blur-sm rounded-2xl p-6 shadow-lg border border-emerald-100",children:[i.jsxs("div",{className:"flex flex-col md:flex-row gap-4 mb-6",children:[i.jsxs("div",{className:"flex-1 relative",children:[i.jsx(yt,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-5 h-5"}),i.jsx(be,{placeholder:"Search tickets...",value:r,onChange:c=>n(c.target.value),className:"pl-10 border-emerald-200 focus:border-emerald-500 focus:ring-emerald-500"})]}),i.jsxs("div",{className:"flex gap-3",children:[i.jsxs(ae,{value:o,onValueChange:s,children:[i.jsxs(ne,{className:"w-[150px] border-emerald-200",children:[i.jsx(Ee,{className:"w-4 h-4 mr-2"}),i.jsx(ie,{})]}),i.jsxs(se,{children:[i.jsx(A,{value:"all",children:"All Status"}),i.jsx(A,{value:"open",children:"Open"}),i.jsx(A,{value:"in-progress",children:"In Progress"}),i.jsx(A,{value:"resolved",children:"Resolved"})]})]}),i.jsxs(ae,{value:u,onValueChange:p,children:[i.jsxs(ne,{className:"w-[150px] border-emerald-200",children:[i.jsx(Ee,{className:"w-4 h-4 mr-2"}),i.jsx(ie,{})]}),i.jsxs(se,{children:[i.jsx(A,{value:"all",children:"All Priority"}),i.jsx(A,{value:"low",children:"Low"}),i.jsx(A,{value:"medium",children:"Medium"}),i.jsx(A,{value:"high",children:"High"})]})]})]})]}),l.length===0?i.jsx("div",{className:"text-center py-12",children:i.jsx("p",{className:"text-gray-500",children:"No tickets found"})}):i.jsx("div",{className:"space-y-3",children:l.map((c,f)=>i.jsx(R.div,{initial:{opacity:0,x:-20},animate:{opacity:1,x:0},transition:{duration:.3,delay:f*.05},className:"p-5 rounded-xl bg-gradient-to-r from-emerald-50 to-teal-50 border border-emerald-200 hover:shadow-md transition-all",children:i.jsxs("div",{className:"flex items-start justify-between gap-4",children:[i.jsxs("div",{className:"flex-1",children:[i.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[i.jsxs("span",{className:"font-mono text-sm font-semibold text-emerald-700",children:["#",c.ticketNumber]}),i.jsx("span",{className:`px-3 py-1 rounded-full text-xs font-medium ${c.priority==="high"?"bg-red-100 text-red-700":c.priority==="medium"?"bg-amber-100 text-amber-700":"bg-blue-100 text-blue-700"}`,children:c.priority}),i.jsx("span",{className:`px-3 py-1 rounded-full text-xs font-medium ${c.status==="resolved"?"bg-green-100 text-green-700":c.status==="in-progress"?"bg-blue-100 text-blue-700":"bg-amber-100 text-amber-700"}`,children:c.status})]}),i.jsx("h3",{className:"font-semibold text-gray-800 mb-1",children:c.subject}),i.jsx("p",{className:"text-sm text-gray-600 line-clamp-2 mb-2",children:c.description}),i.jsxs("div",{className:"flex items-center gap-4 text-xs text-gray-500",children:[i.jsxs("span",{children:["Category: ",c.category]}),i.jsx("span",{children:"â€¢"}),i.jsx("span",{children:new Date(c.createdAt).toLocaleDateString()})]})]}),i.jsxs("div",{className:"flex gap-2",children:[i.jsx(E,{onClick:()=>e(c),variant:"outline",size:"sm",className:"border-emerald-300 text-emerald-700 hover:bg-emerald-50",children:i.jsx(ft,{className:"w-4 h-4"})}),i.jsx(E,{onClick:()=>d(c.id,c.ticketNumber),variant:"outline",size:"sm",className:"border-red-300 text-red-700 hover:bg-red-50",children:i.jsx(gt,{className:"w-4 h-4"})})]})]})},c.id))})]})]})},Vr=({title:t,value:e,icon:a,color:r,bgColor:n})=>{const o=a;return i.jsxs("div",{className:"bg-white/80 backdrop-blur-sm rounded-2xl p-4 shadow-lg border border-emerald-100 flex items-center gap-4",children:[i.jsx("div",{className:`p-3 rounded-full ${n}`,children:i.jsx(o,{className:`w-6 h-6 ${r}`})}),i.jsxs("div",{children:[i.jsx("p",{className:"text-sm text-slate-500",children:t}),i.jsx("p",{className:"text-2xl font-bold text-slate-800",children:e})]})]})},Mr=({tickets:t,onViewTicket:e,onNewTicket:a,onTicketsUpdated:r})=>{const n=t.reduce((l,d)=>(l[d.status]=(l[d.status]||0)+1,l),{open:0,"in-progress":0,resolved:0}),o=t.reduce((l,d)=>(l[d.category]=(l[d.category]||0)+1,l),{}),s=Object.entries(o).map(([l,d])=>({name:l,value:d})),u=["#0088FE","#00C49F","#FFBB28","#FF8042"],p=[{title:"Open Tickets",value:n.open,icon:ht,color:"text-amber-600",bgColor:"bg-amber-100"},{title:"In Progress",value:n["in-progress"],icon:bt,color:"text-blue-600",bgColor:"bg-blue-100"},{title:"Resolved",value:n.resolved,icon:xt,color:"text-green-600",bgColor:"bg-green-100"}];return i.jsxs("div",{className:"space-y-8",children:[i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsx("h1",{className:"text-3xl font-bold bg-gradient-to-r from-emerald-600 to-teal-600 bg-clip-text text-transparent",children:"Support Dashboard"}),i.jsxs(E,{onClick:a,className:"bg-emerald-600 hover:bg-emerald-700 text-white",children:[i.jsx(jt,{className:"w-4 h-4 mr-2"}),"New Ticket"]})]}),i.jsx(R.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5,delay:.1},className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:p.map((l,d)=>i.jsx(R.div,{initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},transition:{delay:.2+d*.1},children:i.jsx(Vr,{...l})},l.title))}),i.jsxs(R.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5,delay:.2},className:"grid grid-cols-1 lg:grid-cols-2 gap-8",children:[i.jsxs("div",{className:"bg-white/80 backdrop-blur-sm rounded-2xl p-6 shadow-lg border border-emerald-100",children:[i.jsx("h3",{className:"text-lg font-semibold text-slate-800 mb-4",children:"Tickets by Category"}),t.length>0?i.jsx(Ie,{width:"100%",height:300,children:i.jsxs(Ir,{children:[i.jsx(I,{data:s,cx:"50%",cy:"50%",labelLine:!1,outerRadius:100,fill:"#8884d8",dataKey:"value",label:({name:l,percent:d})=>`${l} ${(d*100).toFixed(0)}%`,children:s.map((l,d)=>i.jsx(tt,{fill:u[d%u.length]},`cell-${d}`))}),i.jsx(Le,{})]})}):i.jsx("p",{className:"text-center text-slate-500 py-12",children:"No ticket data to display."})]}),i.jsxs("div",{className:"bg-white/80 backdrop-blur-sm rounded-2xl p-6 shadow-lg border border-emerald-100",children:[i.jsx("h3",{className:"text-lg font-semibold text-slate-800 mb-4",children:"Tickets by Status"}),t.length>0?i.jsx(Ie,{width:"100%",height:300,children:i.jsxs(Dt,{data:[n],children:[i.jsx(Ft,{dataKey:"name",hide:!0}),i.jsx(Bt,{}),i.jsx(Le,{}),i.jsx(ge,{dataKey:"open",stackId:"a",fill:"#F59E0B",name:"Open"}),i.jsx(ge,{dataKey:"in-progress",stackId:"a",fill:"#3B82F6",name:"In Progress"}),i.jsx(ge,{dataKey:"resolved",stackId:"a",fill:"#10B981",name:"Resolved"})]})}):i.jsx("p",{className:"text-center text-slate-500 py-12",children:"No ticket data to display."})]})]}),i.jsx(Kr,{tickets:t,onViewTicket:e,onTicketsUpdated:r})]})},qr=({onBack:t,onSubmit:e})=>{const[a,r]=N.useState(""),[n,o]=N.useState(""),[s,u]=N.useState(""),[p,l]=N.useState(""),{toast:d}=Ze(),c=f=>{if(f.preventDefault(),!a||!n||!s||!p){d({title:"Missing Fields",description:"Please fill out all required fields.",variant:"destructive"});return}const b={ticketNumber:ut(),subject:a,category:n,priority:s,description:p};e(b)};return i.jsxs(R.div,{initial:{opacity:0,x:50},animate:{opacity:1,x:0},exit:{opacity:0,x:-50},className:"space-y-6",children:[i.jsxs("div",{className:"flex items-center gap-4",children:[i.jsx(E,{variant:"ghost",size:"icon",onClick:t,children:i.jsx(at,{className:"w-5 h-5"})}),i.jsx("h1",{className:"text-3xl font-bold bg-gradient-to-r from-emerald-600 to-teal-600 bg-clip-text text-transparent",children:"Create New Ticket"})]}),i.jsxs("form",{onSubmit:c,className:"bg-white/80 backdrop-blur-sm rounded-2xl p-8 shadow-lg border border-emerald-100 space-y-6",children:[i.jsxs("div",{className:"space-y-2",children:[i.jsx(ee,{htmlFor:"subject",children:"Subject *"}),i.jsx(be,{id:"subject",value:a,onChange:f=>r(f.target.value),placeholder:"Briefly describe your issue"})]}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[i.jsxs("div",{className:"space-y-2",children:[i.jsx(ee,{htmlFor:"category",children:"Category *"}),i.jsxs(ae,{onValueChange:o,value:n,children:[i.jsx(ne,{id:"category",children:i.jsx(ie,{placeholder:"Select a category"})}),i.jsxs(se,{children:[i.jsx(A,{value:"technical",children:"Technical"}),i.jsx(A,{value:"billing",children:"Billing"}),i.jsx(A,{value:"feature-request",children:"Feature Request"}),i.jsx(A,{value:"general",children:"General"})]})]})]}),i.jsxs("div",{className:"space-y-2",children:[i.jsx(ee,{htmlFor:"priority",children:"Priority *"}),i.jsxs(ae,{onValueChange:u,value:s,children:[i.jsx(ne,{id:"priority",children:i.jsx(ie,{placeholder:"Select a priority level"})}),i.jsxs(se,{children:[i.jsx(A,{value:"low",children:"Low"}),i.jsx(A,{value:"medium",children:"Medium"}),i.jsx(A,{value:"high",children:"High"})]})]})]})]}),i.jsxs("div",{className:"space-y-2",children:[i.jsx(ee,{htmlFor:"description",children:"Description *"}),i.jsx(rt,{id:"description",value:p,onChange:f=>l(f.target.value),placeholder:"Provide a detailed description of the issue",className:"min-h-[150px]"})]}),i.jsxs("div",{className:"space-y-2",children:[i.jsx(ee,{htmlFor:"attachment",children:"Attachment (Optional)"}),i.jsx("div",{className:"flex items-center justify-center w-full",children:i.jsxs("label",{htmlFor:"attachment",className:"flex flex-col items-center justify-center w-full h-32 border-2 border-emerald-300 border-dashed rounded-lg cursor-pointer bg-emerald-50/50 hover:bg-emerald-100/50",children:[i.jsxs("div",{className:"flex flex-col items-center justify-center pt-5 pb-6",children:[i.jsx(nt,{className:"w-8 h-8 mb-3 text-emerald-500"}),i.jsxs("p",{className:"mb-2 text-sm text-emerald-700",children:[i.jsx("span",{className:"font-semibold",children:"Click to upload"})," or drag and drop"]}),i.jsx("p",{className:"text-xs text-slate-500",children:"Images, PDFs, Documents (MAX. 5MB)"})]}),i.jsx(be,{id:"attachment",type:"file",className:"hidden"})]})})]}),i.jsxs("div",{className:"flex justify-end gap-4 pt-4",children:[i.jsx(E,{type:"button",variant:"outline",onClick:t,children:"Cancel"}),i.jsx(E,{type:"submit",className:"bg-emerald-600 hover:bg-emerald-700 text-white",children:"Submit Ticket"})]})]})]})},zr=({ticket:t,onBack:e,onUpdate:a,onAddResponse:r})=>{const[n,o]=N.useState(""),{user:s}=Xe(),u=s.role==="ROLE_VFLEX_ADMIN"||s.role==="ROLE_IT_SUPPORT";if(!t)return i.jsxs("div",{children:[i.jsx("p",{children:"Ticket not found."}),i.jsx(E,{onClick:e,children:"Go Back"})]});const p=f=>{a(t.id,{status:f})},l=()=>{n.trim()&&(r(t.id,n),o(""))},d=f=>{switch(f){case"resolved":return"bg-green-100 text-green-700";case"in-progress":return"bg-blue-100 text-blue-700";case"open":default:return"bg-amber-100 text-amber-700"}},c=f=>{switch(f){case"high":return"bg-red-100 text-red-700";case"medium":return"bg-amber-100 text-amber-700";case"low":default:return"bg-blue-100 text-blue-700"}};return i.jsxs(R.div,{initial:{opacity:0,x:50},animate:{opacity:1,x:0},exit:{opacity:0,x:-50},className:"space-y-6",children:[i.jsxs("div",{className:"flex items-center gap-4",children:[i.jsx(E,{variant:"ghost",size:"icon",onClick:e,children:i.jsx(at,{className:"w-5 h-5"})}),i.jsxs("div",{children:[i.jsx("h1",{className:"text-2xl font-bold text-slate-800",children:t.subject}),i.jsxs("p",{className:"text-sm text-slate-500",children:["Ticket #",t.ticketNumber]})]})]}),i.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[i.jsxs("div",{className:"lg:col-span-2 space-y-6",children:[i.jsxs("div",{className:"bg-white/80 backdrop-blur-sm rounded-2xl p-6 shadow-lg border border-emerald-100",children:[i.jsx("h3",{className:"font-semibold text-lg mb-4 border-b pb-2",children:"Conversation"}),i.jsxs("div",{className:"space-y-6",children:[i.jsxs("div",{className:"flex gap-4",children:[i.jsx($e,{className:"w-8 h-8 text-slate-400 mt-1"}),i.jsxs("div",{className:"flex-1 bg-emerald-50/60 rounded-lg p-4",children:[i.jsx("p",{className:"font-semibold text-slate-700",children:"Original Request"}),i.jsx("p",{className:"text-sm text-slate-600 whitespace-pre-wrap",children:t.description}),i.jsx("p",{className:"text-xs text-slate-400 mt-2",children:new Date(t.createdAt).toLocaleString()})]})]}),t.responses&&t.responses.map((f,b)=>i.jsxs("div",{className:"flex gap-4",children:[i.jsx($e,{className:"w-8 h-8 text-slate-400 mt-1"}),i.jsxs("div",{className:"flex-1 bg-blue-50/60 rounded-lg p-4",children:[i.jsx("p",{className:"font-semibold text-slate-700",children:"Response"}),i.jsx("p",{className:"text-sm text-slate-600 whitespace-pre-wrap",children:f.message}),i.jsx("p",{className:"text-xs text-slate-400 mt-2",children:new Date(f.timestamp).toLocaleString()})]})]},b))]})]}),i.jsxs("div",{className:"bg-white/80 backdrop-blur-sm rounded-2xl p-6 shadow-lg border border-emerald-100",children:[i.jsx("h3",{className:"font-semibold text-lg mb-4",children:"Add a Response"}),i.jsxs("div",{className:"space-y-4",children:[i.jsx(rt,{value:n,onChange:f=>o(f.target.value),placeholder:"Type your response here...",className:"min-h-[120px]"}),i.jsxs("div",{className:"flex justify-between items-center",children:[i.jsx(E,{variant:"outline",size:"icon",disabled:!0,children:i.jsx(nt,{className:"w-4 h-4"})}),i.jsxs(E,{onClick:l,className:"bg-emerald-600 hover:bg-emerald-700 text-white",children:[i.jsx(Kt,{className:"w-4 h-4 mr-2"}),"Send Response"]})]})]})]})]}),i.jsx("div",{className:"lg:col-span-1 space-y-6",children:i.jsxs("div",{className:"bg-white/80 backdrop-blur-sm rounded-2xl p-6 shadow-lg border border-emerald-100 space-y-4",children:[i.jsx("h3",{className:"font-semibold text-lg",children:"Ticket Details"}),i.jsxs("div",{className:"flex justify-between items-center",children:[i.jsx("span",{className:"text-sm text-slate-500",children:"Status"}),u?i.jsxs(ae,{value:t.status,onValueChange:p,children:[i.jsx(ne,{className:`w-[150px] h-8 text-xs font-medium ${d(t.status)}`,children:i.jsx(ie,{})}),i.jsxs(se,{children:[i.jsx(A,{value:"open",children:"Open"}),i.jsx(A,{value:"in-progress",children:"In Progress"}),i.jsx(A,{value:"resolved",children:"Resolved"})]})]}):i.jsx("span",{className:`px-3 py-1 rounded-full text-xs font-medium ${d(t.status)}`,children:t.status})]}),i.jsxs("div",{className:"flex justify-between items-center",children:[i.jsx("span",{className:"text-sm text-slate-500",children:"Priority"}),i.jsx("span",{className:`px-3 py-1 rounded-full text-xs font-medium ${c(t.priority)}`,children:t.priority})]}),i.jsxs("div",{className:"flex justify-between items-center",children:[i.jsx("span",{className:"text-sm text-slate-500",children:"Category"}),i.jsx("span",{className:"font-medium text-sm text-slate-700",children:t.category})]}),i.jsxs("div",{className:"flex justify-between items-center",children:[i.jsx("span",{className:"text-sm text-slate-500",children:"Created"}),i.jsx("span",{className:"font-medium text-sm text-slate-700",children:new Date(t.createdAt).toLocaleDateString()})]})]})})]})]})},ra=()=>{const[t,e]=N.useState("dashboard"),[a,r]=N.useState([]),[n,o]=N.useState(null),{toast:s}=Ze(),{user:u}=Xe(),p=N.useCallback(async()=>{const m=await Lr();r(m)},[]);N.useEffect(()=>{p()},[p]);const l=async m=>{try{const x=await $r(m,u==null?void 0:u.id);s({title:"Ticket Created!",description:`Ticket #${x.ticketNumber} has been successfully created.`});const y={}.VITE_ADMIN_EMAIL||"admin@example.com";try{await M.functions.invoke("send-email",{body:{to:y,templateId:"ticket_created",subject:`New Support Ticket #${x.ticketNumber}`,html:`<p>A new support ticket has been created.</p><p><strong>Ticket #:</strong> ${x.ticketNumber}<br/><strong>Title:</strong> ${x.title||""}</p>`}})}catch{}p(),e("dashboard")}catch{s({title:"Error",description:"Failed to create ticket. Please try again.",variant:"destructive"})}},d=m=>{o(m),e("detail")},c=()=>{o(null),e("dashboard")},f=async(m,x)=>{try{const y=await Dr(m,x);s({title:"Ticket Updated",description:"The ticket status has been changed."}),p(),n&&n.id===m&&y&&o(y)}catch{s({title:"Error",description:"Failed to update ticket. Please try again.",variant:"destructive"})}},b=async(m,x)=>{try{const y=await Br(m,x);s({title:"Response Added",description:"Your response has been added to the ticket."}),p(),n&&n.id===m&&y&&o(y)}catch{s({title:"Error",description:"Failed to add response. Please try again.",variant:"destructive"})}},v=()=>{switch(t){case"create":return i.jsx(qr,{onBack:c,onSubmit:l});case"detail":return i.jsx(zr,{ticket:n,onBack:c,onUpdate:f,onAddResponse:b});case"dashboard":default:return i.jsx(Mr,{tickets:a,onViewTicket:d,onNewTicket:()=>e("create"),onTicketsUpdated:p})}};return i.jsx(R.div,{initial:{opacity:0},animate:{opacity:1},transition:{duration:.5},children:i.jsx(vt,{mode:"wait",children:i.jsx(R.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},exit:{opacity:0,y:-20},transition:{duration:.3},children:v()},t)})})};export{ra as default};

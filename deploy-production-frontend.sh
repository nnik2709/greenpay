#!/bin/bash

# Deploy Production Frontend to greenpay.eywademo.cloud
# Replaces localhost:3000 with production domain

echo "üöÄ Deploying Production Frontend..."
echo ""

SERVER="root@72.61.208.79"
REMOTE_DIR="/home/eywademo-greenpay/htdocs/greenpay.eywademo.cloud"
BACKEND_DIR="$REMOTE_DIR/backend"

echo "üì¶ Build created successfully in dist/"
echo ""

echo "üìã Manual Deployment Steps:"
echo ""
echo "1Ô∏è‚É£  Upload dist/ folder contents to server:"
echo "    Local: /Users/nikolay/github/greenpay/dist/*"
echo "    Server: $REMOTE_DIR/"
echo ""
echo "    Via file manager:"
echo "    - Delete all files in $REMOTE_DIR (EXCEPT backend/ folder)"
echo "    - Upload all files from dist/ folder"
echo ""
echo "2Ô∏è‚É£  Update backend .env for production domain:"
echo "    ssh $SERVER"
echo "    cd $BACKEND_DIR"
echo "    nano .env"
echo ""
echo "    Change this line:"
echo "    PUBLIC_URL=http://localhost:3000"
echo ""
echo "    To:"
echo "    PUBLIC_URL=https://greenpay.eywademo.cloud"
echo ""
echo "3Ô∏è‚É£  Restart backend:"
echo "    pm2 restart greenpay-api"
echo ""
echo "4Ô∏è‚É£  Test the production site:"
echo "    Visit: https://greenpay.eywademo.cloud/buy-voucher"
echo "    Make a test purchase"
echo "    Email link should now use https://greenpay.eywademo.cloud"
echo ""
echo "üìù What Changed:"
echo "   ‚úì Frontend now uses https://greenpay.eywademo.cloud/api"
echo "   ‚úì Stripe checkout returns to production domain"
echo "   ‚úì Email links use production domain"
echo "   ‚úì All references to localhost:3000 removed"
echo ""

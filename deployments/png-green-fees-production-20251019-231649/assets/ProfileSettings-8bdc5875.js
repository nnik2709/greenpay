import{v as b,u as C,r as l,s as p,j as e,m as E,C as h,a as f,b as u,d as j,L as g,I as v,B as y}from"./index-f386841f.js";import{U as F}from"./user-806b4eaa.js";import{R as N}from"./refresh-cw-4076d92b.js";import{S as P}from"./save-bfaf2e9f.js";import{S as I}from"./shield-c3edc8ad.js";const k=()=>{const{user:r}=b(),{toast:i}=C(),[s,n]=l.useState({email:"",full_name:"",role:"",active:!0}),[_,d]=l.useState(!0),[c,o]=l.useState(!1);l.useEffect(()=>{r!=null&&r.id&&m()},[r==null?void 0:r.id]);const m=async()=>{try{d(!0);const{data:a,error:t}=await p.rpc("get_user_profile",{p_user_id:r.id});if(t)throw t;a&&a.length>0&&n(a[0])}catch(a){console.error("Error fetching profile:",a),i({title:"Error",description:"Failed to load profile",variant:"destructive"})}finally{d(!1)}},S=async()=>{try{o(!0);const{error:a}=await p.rpc("update_user_profile",{p_user_id:r.id,p_full_name:s.full_name,p_email:s.email});if(a)throw a;i({title:"Success",description:"Profile updated successfully"})}catch(a){console.error("Error updating profile:",a),i({title:"Error",description:"Failed to update profile",variant:"destructive"})}finally{o(!1)}},x=(a,t)=>{n(w=>({...w,[a]:t}))};return _?e.jsx("div",{className:"flex items-center justify-center min-h-[400px]",children:e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-emerald-600"})}):e.jsxs(E.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5},className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(F,{className:"w-8 h-8 text-emerald-600"}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-800",children:"Profile Settings"}),e.jsx("p",{className:"text-gray-500",children:"Manage your personal information and preferences"})]})]}),e.jsxs(h,{children:[e.jsx(f,{children:e.jsx(u,{children:"Personal Information"})}),e.jsxs(j,{className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(g,{htmlFor:"email",children:"Email Address"}),e.jsx(v,{id:"email",type:"email",value:s.email,onChange:a=>x("email",a.target.value),placeholder:"Enter email address"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(g,{htmlFor:"full_name",children:"Full Name"}),e.jsx(v,{id:"full_name",type:"text",value:s.full_name,onChange:a=>x("full_name",a.target.value),placeholder:"Enter full name"})]})]}),e.jsxs("div",{className:"flex gap-3 pt-4",children:[e.jsx(y,{onClick:S,disabled:c,children:c?e.jsxs(e.Fragment,{children:[e.jsx(N,{className:"w-4 h-4 mr-2 animate-spin"}),"Saving..."]}):e.jsxs(e.Fragment,{children:[e.jsx(P,{className:"w-4 h-4 mr-2"}),"Save Profile"]})}),e.jsxs(y,{variant:"outline",onClick:m,children:[e.jsx(N,{className:"w-4 h-4 mr-2"}),"Refresh"]})]})]})]}),e.jsxs(h,{children:[e.jsx(f,{children:e.jsxs(u,{className:"flex items-center gap-2",children:[e.jsx(I,{className:"w-5 h-5"}),"Account Information"]})}),e.jsx(j,{children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 text-sm",children:[e.jsxs("div",{children:[e.jsx("span",{className:"font-medium text-gray-700",children:"Role:"}),e.jsx("span",{className:"ml-2 px-2 py-1 bg-emerald-100 text-emerald-800 rounded-full text-xs",children:s.role})]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-medium text-gray-700",children:"Status:"}),e.jsx("span",{className:`ml-2 px-2 py-1 rounded-full text-xs ${s.active?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}`,children:s.active?"Active":"Inactive"})]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-medium text-gray-700",children:"Member Since:"}),e.jsx("span",{className:"ml-2 text-gray-600",children:s.created_at?new Date(s.created_at).toLocaleDateString():"Unknown"})]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-medium text-gray-700",children:"Last Updated:"}),e.jsx("span",{className:"ml-2 text-gray-600",children:s.updated_at?new Date(s.updated_at).toLocaleDateString():"Never"})]})]})})]})]})};export{k as default};
